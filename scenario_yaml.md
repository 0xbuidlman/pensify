# Test Scenario format description
Test scenarios for Akropolis pool testing are contructed in YAML format.
Here is the description of available commands and their parameters.
Scenarios are consctructed from commands, which are executed in the same order as they are writen in the scenario file.

## Available commands

### Configuration and reports

#### groups
Create named groups of users (addresses), which can be referenced in other commands.
Addresses in tests are generated by [HDWalletProvider](https://github.com/trufflesuite/truffle-hdwallet-provider).
A group should list indexes of address to be assigned to this group.
```yaml
groups:
    group1: [10,11,12,13,14,15]
    group2: [20,21,22,23,24,25]
```

#### report-type
Define types of the reports: which information `report` command has to store.
For this command one should specify contracts and their methods with arguments to call.
Results of the call will be stored in a log.
```yaml
report-type:
    name: myReportType
    contracts:
        - Contract1:
          - method1: [argument1, argument2]
          - method2: [argument1, argument2]
```

#### report
Store current state of the contract(s) defined in `report-type` to a log file.
```yaml
report: myReportType
``` 

### Actions

#### fund
Fund each user in the `group` with `amount` DAI
```yaml
fund:
    group: group1 
    amount: 100
```

#### deposit
For each user in the `group` deposit `amount` DAI to the pool, 
waiting for `sleep` seconds after each user.
```yaml
deposit:
    group: group1 
    amount: 100
    sleep: 10
```

#### withdraw
For each user in the `group` withdraw `amount` DAI from the pool, 
waiting for `sleep` seconds after each user.
```yaml
withdraw:
    group: group1 
    amount: 100
    sleep: 10
```

#### createDebt
For each user in the `borrowers` group creates a debt proposal for `amount` DAI,
then for each user in `supporters` group add pledge to this proposals
and then executes proposals, waiting for `sleep` after each operation for each user.
Debt `name` should be used later to operate with created debts.
```yaml
createDebt:
    name: debt1
    borrowers: group1 
    supporters: group2 
    amount: 100
    sleep: 10
```

#### repay
For each user in the `borrowers` repays debt `name` with `amount` DAI,
waiting for `sleep` seconds after each user.
```yaml
repay:
    name: debt1
    borrowers: group1 
    amount: 100
    sleep: 10
```

#### withdrawPledge
For each user in the `supporters` withdraws (unlocked) pledge from the debt `name`,
waiting for `sleep` seconds after each user.
```yaml
withdrawUnlockedPledge:
    name: debt1
    supporters: group2 
    sleep: 10
```





